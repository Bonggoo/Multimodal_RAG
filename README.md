# Multimodal RAG for Technical Manuals

## ğŸ“– í”„ë¡œì íŠ¸ ê°œìš” (Overview)

ë³¸ í”„ë¡œì íŠ¸ëŠ” ë³µì¡í•œ ê¸°ìˆ  ë§¤ë‰´ì–¼(PDF í˜•ì‹)ì„ ìœ„í•œ ê³ ê¸‰ ë©€í‹°ëª¨ë‹¬ RAG(Retrieval-Augmented Generation) ì‹œìŠ¤í…œì…ë‹ˆë‹¤. Google Gemini Pro ë©€í‹°ëª¨ë‹¬ ëª¨ë¸ì„ í™œìš©í•˜ì—¬ í…ìŠ¤íŠ¸ë¿ë§Œ ì•„ë‹ˆë¼ ë¬¸ì„œ ë‚´ì˜ ì´ë¯¸ì§€, í…Œì´ë¸”ê¹Œì§€ ê¹Šì´ ì´í•´í•˜ê³ , ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ì •í™•í•˜ê²Œ ë‹µë³€í•©ë‹ˆë‹¤.

## âœ¨ ì£¼ìš” ê¸°ëŠ¥ (Key Features)

- **ë©€í‹°ëª¨ë‹¬ ë¬¸ì„œ ì´í•´**: Gemini ëª¨ë¸ì„ í†µí•´ PDF í˜ì´ì§€ì˜ í…ìŠ¤íŠ¸, í…Œì´ë¸”, ì´ë¯¸ì§€ë¥¼ ë™ì‹œì— ë¶„ì„í•˜ê³  êµ¬ì¡°í™”ëœ JSON ë°ì´í„°ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
- **í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (Hybrid Search)**: ì˜ë¯¸ ê¸°ë°˜ì˜ ë²¡í„° ê²€ìƒ‰(Dense)ê³¼ í‚¤ì›Œë“œ ê¸°ë°˜ì˜ BM25 ê²€ìƒ‰(Sparse)ì„ ê²°í•©í•œ `EnsembleRetriever`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²€ìƒ‰ ì •í™•ë„ë¥¼ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.
- **ì¿¼ë¦¬ í™•ì¥ (Query Expansion)**: LLMì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì„ ê²€ìƒ‰ì— ìµœì í™”ëœ ì—¬ëŸ¬ í‚¤ì›Œë“œë¡œ í™•ì¥í•˜ì—¬ ê´€ë ¨ì„± ë†’ì€ ë¬¸ì„œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì°¾ìŠµë‹ˆë‹¤.
- **ì •í™•í•œ ì¶œì²˜ ì¸ìš©**: ë‹µë³€ ìƒì„± ì‹œ, LLMì´ ì‹¤ì œë¡œ ì°¸ê³ í•œ ë¬¸ì„œ í˜ì´ì§€ì˜ ì´ë¯¸ì§€ë¥¼ ì •í™•íˆ ì‹ë³„í•˜ê³  ì¶œì²˜ë¡œ í•¨ê»˜ ì œê³µí•©ë‹ˆë‹¤.
- **ë³‘ë ¬ ì²˜ë¦¬**: `ThreadPoolExecutor`ë¥¼ í™œìš©í•˜ì—¬ ë¬¸ì„œ ì²˜ë¦¬(Ingestion) ê³¼ì •ì„ ë³‘ë ¬í™”í•˜ì—¬ ëŒ€ìš©ëŸ‰ ë¬¸ì„œë„ ë¹ ë¥´ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **CLI ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤**: `Typer`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ì„œ ì—…ë¡œë“œ(`ingest`)ì™€ ì§ˆì˜ì‘ë‹µ(`qa`) ê¸°ëŠ¥ì„ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ›ï¸ ì•„í‚¤í…ì²˜ (Architecture)

### ë°ì´í„° ìˆ˜ì§‘ (Ingestion) íŒŒì´í”„ë¼ì¸
```mermaid
graph TD
    A["PDF íŒŒì¼ ì…ë ¥"] --> B["1. í˜ì´ì§€ ë¶„í•  ë° ì¸ë„¤ì¼ ìƒì„±"]
    B --> C["2. í˜ì´ì§€ë³„ ë³‘ë ¬ ì²˜ë¦¬"]
    C --> D["3. Gemini ë©€í‹°ëª¨ë‹¬ íŒŒì‹±
(í…ìŠ¤íŠ¸, í…Œì´ë¸”, ì´ë¯¸ì§€ ì¶”ì¶œ)"]
    D --> E("4. êµ¬ì¡°í™”ëœ ë°ì´í„°
(JSON)")
    E --> F["5. ChromaDB ì €ì¥
(ë²¡í„° ì„ë² ë”©)"]
    E --> G["6. BM25 ì¸ë±ìŠ¤ ìƒì„±"]
```

### ì§ˆì˜ì‘ë‹µ (QA) íŒŒì´í”„ë¼ì¸
```mermaid
graph TD
    subgraph "1. ê²€ìƒ‰ (Retrieval)"
        A["ì‚¬ìš©ì ì§ˆë¬¸"] --> B["ì¿¼ë¦¬ í™•ì¥(LLM)"]
        B --> C["í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰
(BM25 + ChromaDB)"]
    end

    C --> D["ê´€ë ¨ ë¬¸ì„œ ë°
ì´ë¯¸ì§€ ê²½ë¡œ ì¶”ì¶œ"]

    subgraph "2. ìƒì„± (Generation)"
        D --> E["ì»¨í…ìŠ¤íŠ¸ í¬ë§·íŒ…
(ì´ë¯¸ì§€ ì¶œì²˜ í¬í•¨)"]
        E --> F["ë‹µë³€ ìƒì„±(LLM)
+ ì¶œì²˜ ì¸ìš©"]
        F --> G["ìµœì¢… ë‹µë³€ +
ì¸ìš©ëœ ì´ë¯¸ì§€ ëª©ë¡"]
    end
```

## ğŸ› ï¸ ì„¤ì¹˜ (Installation)

1.  **Git ì €ì¥ì†Œ ë³µì œ:**
    ```bash
    git clone https://github.com/your-username/Multimodal_RAG.git
    cd Multimodal_RAG
    ```

2.  **ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”:**
    ```bash
    python -m venv venv
    source venv/bin/activate  # macOS/Linux
    # venv\Scripts\activate    # Windows
    ```

3.  **ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ì„¤ì¹˜:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •:**
    `.env` íŒŒì¼ì„ í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ì— ìƒì„±í•˜ê³  Google API í‚¤ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
    ```
    GOOGLE_API_KEY="ì—¬ê¸°ì—_ë‹¹ì‹ ì˜_API_í‚¤ë¥¼_ì…ë ¥í•˜ì„¸ìš”"
    ```

## ğŸš€ ì‚¬ìš©ë²• (Usage)

### 1. ë¬¸ì„œ ì²˜ë¦¬ (Ingest)

`ingest` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ PDF ë¬¸ì„œë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€í•©ë‹ˆë‹¤.

```bash
python main.py ingest "path/to/your/document.pdf"
```

-   `--workers` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë™ì‹œì— ì²˜ë¦¬í•  ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ê¸°ë³¸ê°’: 50)
    ```bash
    python main.py ingest "path/to/your/document.pdf" --workers 10
    ```

### 2. ì§ˆì˜ì‘ë‹µ (QA)

`qa` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœ ë¬¸ì„œì— ëŒ€í•´ ì§ˆë¬¸í•©ë‹ˆë‹¤.

```bash
python main.py qa "ì›ì  ë³µê·€ ë°©ì‹ì—ëŠ” ì–´ë–¤ ì¢…ë¥˜ê°€ ìˆë‚˜ìš”?"
```

#### ì‹¤í–‰ ì˜ˆì‹œ

```
$ python main.py qa "JOG ìš´ì „ ì†ë„ë¥¼ ì„¤ì •í•˜ëŠ” íŒŒë¼ë¯¸í„°ëŠ” ë¬´ì—‡ì¸ê°€ìš”?"

ì§ˆë¬¸: 'JOG ìš´ì „ ì†ë„ë¥¼ ì„¤ì •í•˜ëŠ” íŒŒë¼ë¯¸í„°ëŠ” ë¬´ì—‡ì¸ê°€ìš”?'
Retrieverë¥¼ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤...
Retriever ì¤€ë¹„ ì™„ë£Œ. ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤...

---
ë‹µë³€:
JOG ìš´ì „ ì†ë„ë¥¼ ì„¤ì •í•˜ëŠ” íŒŒë¼ë¯¸í„°ëŠ” Pr.7 "JOG ì†ë„"ì…ë‹ˆë‹¤. ì´ íŒŒë¼ë¯¸í„°ëŠ” JOG ìš´ì „ ì‹œì˜ ìœ„ì¹˜ê²°ì • ì†ë„ë¥¼ ì„¤ì •í•˜ë©°, ë‹¨ìœ„ëŠ” [mm/min], [inch/min], [deg/min] ë˜ëŠ” [pulse]ì´ê³  ì„¤ì • ë²”ìœ„ëŠ” 1~2000000000 ì…ë‹ˆë‹¤.

ê´€ë ¨ ì´ë¯¸ì§€:
- assets/images/your_document_name_p123.png
---
```

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
/
â”œâ”€â”€â”€.gitignore
â”œâ”€â”€â”€main.py                 # CLI ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
â”œâ”€â”€â”€requirements.txt        # Python ì˜ì¡´ì„± ëª©ë¡
â”œâ”€â”€â”€To_do_list.md           # ê°œë°œ ì‘ì—… ëª©ë¡
â”œâ”€â”€â”€assets/images/          # ìƒì„±ëœ ì¸ë„¤ì¼ ì´ë¯¸ì§€ ì €ì¥
â”œâ”€â”€â”€chroma_db/              # ChromaDB ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤
â”œâ”€â”€â”€data/                   # ì…ë ¥ PDF ë¬¸ì„œ ë° ìƒì„±ëœ BM25 ì¸ë±ìŠ¤
â””â”€â”€â”€src/
    â”œâ”€â”€â”€parsing/
    â”‚   â”œâ”€â”€â”€parser.py       # Geminië¥¼ ì´ìš©í•œ ë©€í‹°ëª¨ë‹¬ íŒŒì„œ
    â”‚   â””â”€â”€â”€schema.py       # íŒŒì‹± ë°ì´í„° êµ¬ì¡°(Pydantic ëª¨ë¸)
    â”œâ”€â”€â”€preprocessing/
    â”‚   â”œâ”€â”€â”€loader.py       # PDF ë¬¸ì„œ ë¡œë”
    â”‚   â””â”€â”€â”€thumbnail.py    # í˜ì´ì§€ ì¸ë„¤ì¼ ìƒì„±ê¸°
    â”œâ”€â”€â”€retrieval/
    â”‚   â”œâ”€â”€â”€generator.py    # RAG ë‹µë³€ ë° ì¸ìš© ìƒì„±
    â”‚   â”œâ”€â”€â”€query_expansion.py # ì¿¼ë¦¬ í™•ì¥ ëª¨ë“ˆ
    â”‚   â””â”€â”€â”€retriever.py    # í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ê¸°(EnsembleRetriever)
    â””â”€â”€â”€storage/
        â””â”€â”€â”€vector_db.py    # ChromaDB ì¸í„°í˜ì´ìŠ¤
```
